---
import { stegaClean } from '@sanity/client/stega';

import { decodeStegaValue } from '@app/lib/sanity/stega';
import {
  default as GeneralMarkdown,
  type Props as MarkdownProps,
} from '@app/components/general/markdown.astro';
import type { CommonSchemaType } from '@app/types/content';

export type SanityMarkdown = CommonSchemaType<'markdown'>;

export interface Props extends Omit<MarkdownProps, 'content'> {
  md: SanityMarkdown;
}

const props = Astro.props;

const { md, ...rest } = props;
---

<GeneralMarkdown
  data-sanity={decodeStegaValue(md.content)}
  content={(md.content && stegaClean(md.content)) || undefined}
  {...rest}
/>
